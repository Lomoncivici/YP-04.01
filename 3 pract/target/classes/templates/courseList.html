<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>Курсы</title>
  <style>
    body{font-family:Arial;margin:20px}
    table{border-collapse:collapse;width:100%;margin-top:10px}
    th,td{border:1px solid #ddd;padding:8px} th{background:#f0f0f0}
    .deleted{color:#888;text-decoration:line-through}
    .pagination{margin-top:10px;display:flex;gap:8px}
  </style>
</head>
<body>
<h1>Курсы</h1>
<a th:href="@{/students}">← к студентам</a>

<form method="get" th:action="@{/courses}" style="margin-top:10px">
  <label><input type="checkbox" name="onlyActive" th:checked="${onlyActive}"> Только активные</label>
  <select name="sort">
    <option value="title" th:selected="${sort == 'title'}">Название</option>
    <option value="year"  th:selected="${sort == 'year'}">Год</option>
    <option value="id"    th:selected="${sort == 'id'}">ID</option>
  </select>
  <select name="dir">
    <option value="asc"  th:selected="${dir == 'asc'}">↑</option>
    <option value="desc" th:selected="${dir == 'desc'}">↓</option>
  </select>
  <button type="submit">Применить</button>
</form>

<h3>Добавить/обновить курс</h3>
<form method="post" th:action="@{/courses/add}" th:object="${course}">
  <input type="text" th:field="*{title}" placeholder="Название" required/>
  <input type="number" th:field="*{year}" min="1" max="6" placeholder="Год" required/>
  <input type="text" th:field="*{teacher}" placeholder="Преподаватель" required/>
  <select th:field="*{department}" required>
    <option th:each="d : ${departments}" th:value="${d.id}" th:text="${d.name}"></option>
  </select>
  <button type="submit">Сохранить</button>
</form>

<table>
  <thead>
    <tr><th>ID</th><th>Название</th><th>Год</th><th>Преподаватель</th><th>Кафедра</th><th>Статус</th><th>Действия</th></tr>
  </thead>
  <tbody>
    <tr th:each="c : ${page.content}" th:classappend="${c.deleted} ? 'deleted'">
      <td th:text="${c.id}"></td>
      <td th:text="${c.title}"></td>
      <td th:text="${c.year}"></td>
      <td th:text="${c.teacher}"></td>
      <td th:text="${c.department.name}"></td>
      <td th:text="${c.deleted} ? 'удалён' : 'активен'"></td>
      <td>
        <form method="post" th:action="@{/courses/soft-delete}" th:if="${!c.deleted}" style="display:inline-block">
          <input type="hidden" name="id" th:value="${c.id}"/>
          <button>Лог. удалить</button>
        </form>
        <form method="post" th:action="@{/courses/hard-delete}" style="display:inline-block">
          <input type="hidden" name="id" th:value="${c.id}"/>
          <button>Физ. удалить</button>
        </form>
      </td>
    </tr>
  </tbody>
</table>

<div class="pagination">
    <a th:if="${!page.first}"
       th:href="@{/courses(
         pageIndex=${page.number - 1},
         size=${page.size},
         onlyActive=${onlyActive},
         sort=${sort},
         dir=${dir}
     )}">« Назад</a>

    <span>
    <span th:text="${page.number + 1}">1</span>
    /
    <span th:text="${page.totalPages}">1</span>
  </span>

    <a th:if="${!page.last}"
       th:href="@{/courses(
         pageIndex=${page.number + 1},
         size=${page.size},
         onlyActive=${onlyActive},
         sort=${sort},
         dir=${dir}
     )}">Вперёд »</a>
</div>


</body>
</html>
